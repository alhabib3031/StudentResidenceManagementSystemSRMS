@page "/contact"
@* @attribute [Authorize] *@
@inject ISnackbar Snackbar
@using Microsoft.Extensions.Localization
@using SRMS.WebUI.Server.Resources
@inject IStringLocalizer<Resource> L

@rendermode InteractiveServer

<PageTitle>@L["Contact_PageTitle"]</PageTitle>

<MudStack Class="animate-fade-in w-full">
    <!-- Header -->
    <MudStack AlignItems="AlignItems.Center" Class="mb-6 glass-card">
        <MudText Class="text-3xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary mb-2 text-center">
            @L["Contact_GetInTouch"]
        </MudText>
        <MudText Typo="Typo.h6" Color="Color.Secondary">
            @L["Contact_Subtitle"]
        </MudText>
    </MudStack>

    <MudGrid>
        <!-- Contact Form -->
        <MudItem xs="12" md="8">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h5" Class="mb-4 font-bold">
                    <MudIcon Icon="@Icons.Material.Filled.Email" Class="mr-2" />
                    @L["Contact_SendUsMessage"]
                </MudText>

                <EditForm Model="@_contactModel" OnValidSubmit="SubmitForm">
                    <DataAnnotationsValidator />

                    <MudGrid>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="_contactModel.FirstName" Label='@(L["Contact_Label_FirstName"])'
                                Variant="Variant.Outlined" Required="true" For="@(() => _contactModel.FirstName)" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="_contactModel.LastName" Label='@(L["Contact_Label_LastName"])'
                                Variant="Variant.Outlined" Required="true" For="@(() => _contactModel.LastName)" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="_contactModel.Email" Label='@(L["Contact_Label_Email"])'
                                Variant="Variant.Outlined" InputType="InputType.Email" Required="true"
                                For="@(() => _contactModel.Email)" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="_contactModel.Phone" Label='@(L["Contact_Label_Phone"])'
                                Variant="Variant.Outlined" For="@(() => _contactModel.Phone)" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudSelect @bind-Value="_contactModel.Subject" Label='@(L["Contact_Label_Subject"])' Variant="Variant.Outlined"
                                Required="true">
                                <MudSelectItem Value='@(L["Contact_Subject_GeneralInquiry"].Value)'>@(L["Contact_Subject_GeneralInquiry"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_TechnicalSupport"].Value)'>@(L["Contact_Subject_TechnicalSupport"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_BillingQuestion"].Value)'>@(L["Contact_Subject_BillingQuestion"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_FeatureRequest"].Value)'>@(L["Contact_Subject_FeatureRequest"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_BugReport"].Value)'>@(L["Contact_Subject_BugReport"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_Partnership"].Value)'>@(L["Contact_Subject_Partnership"])</MudSelectItem>
                                <MudSelectItem Value='@(L["Contact_Subject_Other"].Value)'>@(L["Contact_Subject_Other"])</MudSelectItem>
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="12">
                            <MudTextField @bind-Value="_contactModel.Message" Label='@(L["Contact_Label_Message"])' Variant="Variant.Outlined"
                                Lines="6" Required="true" For="@(() => _contactModel.Message)" />
                        </MudItem>
                        <MudItem xs="12">
                            <MudCheckBox T="bool" @bind-Checked="_contactModel.AgreeToTerms" Color="Color.Primary">
                                @L["Contact_Terms_Prefix"]<MudLink Href="/terms">@(L["TermsOfService"])</MudLink>@L["Contact_And"]<MudLink Href="/privacy">@(L["PrivacyPolicy"])</MudLink>
                            </MudCheckBox>
                        </MudItem>
                        <MudItem xs="12" Class="flex justify-end gap-3">
                            <MudButton Variant="Variant.Outlined" Color="Color.Default" OnClick="@ResetForm">
                                @(L["Contact_Button_Reset"])
                            </MudButton>
                            <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary"
                                StartIcon="@Icons.Material.Filled.Send" Class="btn-modern btn-primary">
                                @(L["Contact_Button_SendMessage"])
                            </MudButton>
                        </MudItem>
                    </MudGrid>
                </EditForm>
            </MudPaper>
        </MudItem>

        <!-- Contact Information -->
        <MudItem xs="12" md="4">
            <MudStack Spacing="4">
                <!-- Contact Details -->
                <MudPaper Class="glass-card pa-5">
                    <MudText Typo="Typo.h6" Class="mb-4 font-bold">
                        <MudIcon Icon="@Icons.Material.Filled.Info" Class="mr-2" />
                        @(L["Contact_ContactInformation"])
                    </MudText>

                    <MudStack Spacing="3">
                        <MudStack Row="true" AlignItems="AlignItems.Start">
                            <MudIcon Icon="@Icons.Material.Filled.LocationOn" Color="Color.Primary" Class="mr-3 mt-1" />
                            <MudStack Spacing="0">
                                <MudText Typo="Typo.body2" Class="font-semibold">@(L["Contact_Address"])</MudText>
                                <MudText Typo="Typo.body2" Color="Color.Secondary">
                                    @L["Contact_Address_Value"]
                                </MudText>
                            </MudStack>
                        </MudStack>

                        <MudDivider />

                        <MudStack Row="true" AlignItems="AlignItems.Start">
                            <MudIcon Icon="@Icons.Material.Filled.Phone" Color="Color.Success" Class="mr-3 mt-1" />
                            <MudStack Spacing="0">
                                <MudText Typo="Typo.body2" Class="font-semibold">@(L["Contact_Phone"])</MudText>
                                <MudText Typo="Typo.body2" Color="Color.Secondary">
                                    @L["Contact_Phone_Value"]
                                </MudText>
                            </MudStack>
                        </MudStack>

                        <MudDivider />

                        <MudStack Row="true" AlignItems="AlignItems.Start">
                            <MudIcon Icon="@Icons.Material.Filled.Email" Color="Color.Info" Class="mr-3 mt-1" />
                            <MudStack Spacing="0">
                                <MudText Typo="Typo.body2" Class="font-semibold">@(L["Contact_Email"])</MudText>
                                <MudText Typo="Typo.body2" Color="Color.Secondary">
                                    @L["Contact_Email_Value"]
                                </MudText>
                            </MudStack>
                        </MudStack>

                        <MudDivider />

                        <MudStack Row="true" AlignItems="AlignItems.Start">
                            <MudIcon Icon="@Icons.Material.Filled.Schedule" Color="Color.Warning" Class="mr-3 mt-1" />
                            <MudStack Spacing="0">
                                <MudText Typo="Typo.body2" Class="font-semibold">@(L["Contact_BusinessHours"])</MudText>
                                <MudText Typo="Typo.body2" Color="Color.Secondary">
                                    @L["Contact_BusinessHours_Value"]
                                </MudText>
                            </MudStack>
                        </MudStack>
                    </MudStack>
                </MudPaper>

                <!-- Social Media -->
                <MudPaper Class="glass-card pa-5">
                    <MudText Typo="Typo.h6" Class="mb-4 font-bold">
                        <MudIcon Icon="@Icons.Material.Filled.Share" Class="mr-2" />
                        @(L["Contact_FollowUs"])
                    </MudText>

                    <MudStack Row="true" Justify="Justify.SpaceAround">
                        <MudIconButton Icon="@Icons.Custom.Brands.Facebook" Color="Color.Primary" Size="Size.Large"
                            Class="hover-scale" />
                        <MudIconButton Icon="@Icons.Custom.Brands.Twitter" Color="Color.Info" Size="Size.Large"
                            Class="hover-scale" />
                        <MudIconButton Icon="@Icons.Custom.Brands.LinkedIn" Color="Color.Primary" Size="Size.Large"
                            Class="hover-scale" />
                        <MudIconButton Icon="@Icons.Custom.Brands.Instagram" Color="Color.Error" Size="Size.Large"
                            Class="hover-scale" />
                    </MudStack>
                </MudPaper>

                <!-- Quick Links -->
                <MudPaper Class="glass-card pa-5">
                    <MudText Typo="Typo.h6" Class="mb-3 font-bold">
                        <MudIcon Icon="@Icons.Material.Filled.Link" Class="mr-2" />
                        @(L["Contact_QuickLinks"])
                    </MudText>

                    <MudStack Spacing="2">
                        <MudButton Variant="Variant.Text" Color="Color.Primary" FullWidth="true" Href="/help"
                            StartIcon="@Icons.Material.Filled.Help">
                            @(L["Contact_QuickLinks_HelpCenter"])
                        </MudButton>
                        <MudButton Variant="Variant.Text" Color="Color.Primary" FullWidth="true" Href="/about"
                            StartIcon="@Icons.Material.Filled.Info">
                            @(L["Contact_QuickLinks_AboutUs"])
                        </MudButton>
                        <MudButton Variant="Variant.Text" Color="Color.Primary" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.Description">
                            @(L["Contact_QuickLinks_Documentation"])
                        </MudButton>
                    </MudStack>
                </MudPaper>
            </MudStack>
        </MudItem>

        <!-- Map Section (Placeholder) -->
        <MudItem xs="12">
            <MudPaper Class="glass-card p-2 md:p-4 h-[300px] md:h-[400px]">
                @* <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" Class="h-100"> *@
                @*     <MudStack AlignItems="AlignItems.Center" Spacing="0"> *@
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d13356.789!2d20.0574!3d32.1191!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x13a89331d42f5b67%3A0x3a7c9e0e8f8a8a8a!2sUniversity%20of%20Benghazi!5e0!3m2!1sen!2sly!4v1234567890"
                            width="100%" 
                            height="100%" 
                            style="border:0;" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade"
                            class="rounded-xl w-full h-full">
                        </iframe>
                @*     </MudStack> *@
                @* </MudStack> *@
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudStack>

@code {
    private ContactModel _contactModel = new();

    private void SubmitForm()
    {
        if (!_contactModel.AgreeToTerms)
        {
            Snackbar.Add(L["Contact_Snackbar_AgreeTerms"].Value, Severity.Warning);
            return;
        }

        // Submit form to service
        Snackbar.Add(L["Contact_Snackbar_Thanks"].Value, Severity.Success);
        ResetForm();
    }

    private void ResetForm()
    {
        _contactModel = new ContactModel();
    }

    private class ContactModel
    {
        public string FirstName { get; set; } = string.Empty;
        public string LastName { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public string? Phone { get; set; }
        public string Subject { get; set; } = "General Inquiry";
        public string Message { get; set; } = string.Empty;
        public bool AgreeToTerms { get; set; }
    }
}
