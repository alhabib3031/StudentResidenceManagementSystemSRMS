@page "/settings"
@using SRMS.WebUI.Server.Resources
@using Microsoft.Extensions.Localization
@inject ISnackbar Snackbar
@inject IStringLocalizer<Resource> L
@attribute [Authorize]
@rendermode InteractiveServer

<PageTitle>@L["Settings"] - SRMS</PageTitle>

<MudStack Class="animate-fade-in w-full modern-card">
    <MudText Typo="Typo.h4" Class="text-gradient mb-4 font-bold">
        <MudIcon Icon="@Icons.Material.Filled.Settings" Class="mr-2" />
        @L["Settings"]
    </MudText>

    <MudGrid>
        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Tune" Class="mr-2" />
                    @L["GeneralSettings"]
                </MudText>

                <MudStack Spacing="4">
                    <MudSelect @bind-Value="_language" Label="@L["Language"]" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("en")">@L["English"]</MudSelectItem>
                        <MudSelectItem Value="@("ar")">@L["Arabic"]</MudSelectItem>
                    </MudSelect>

                    <MudSelect @bind-Value="_timezone" Label="@L["Timezone"]" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("UTC")">@L["UTC"]</MudSelectItem>
                        <MudSelectItem Value="@("EST")">@L["EST"]</MudSelectItem>
                        <MudSelectItem Value="@("PST")">@L["PST"]</MudSelectItem>
                        <MudSelectItem Value="@("GMT")">@L["GMT"]</MudSelectItem>
                    </MudSelect>

                    <MudSelect @bind-Value="_dateFormat" Label="@L["DateFormat"]" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("MM/DD/YYYY")">@L["MMDDYYYY"]</MudSelectItem>
                        <MudSelectItem Value="@("DD/MM/YYYY")">@L["DDMMYYYY"]</MudSelectItem>
                        <MudSelectItem Value="@("YYYY-MM-DD")">@L["YYYYMMDD"]</MudSelectItem>
                    </MudSelect>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveGeneralSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveGeneralSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Notifications" Class="mr-2" />
                    @L["NotificationSettings"]
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_emailNotifications" Color="Color.Primary">
                            @L["EmailNotifications"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_EmailNotifications"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_smsNotifications" Color="Color.Primary">
                            @L["SMSNotifications"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_SMSNotifications"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_pushNotifications" Color="Color.Primary">
                            @L["PushNotifications"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_PushNotifications"]
                        </MudText>
                    </MudStack>

                    <MudDivider Class="my-2" />

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_paymentNotifications" Color="Color.Success">
                            @L["PaymentNotifications"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_PaymentNotifications"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_complaintNotifications" Color="Color.Warning">
                            @L["ComplaintNotifications"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_ComplaintNotifications"]
                        </MudText>
                    </MudStack>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveNotificationSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveNotificationSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Palette" Class="mr-2" />
                    @L["Appearance"]
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_darkMode" Color="Color.Primary">
                            @L["DarkMode"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_DarkMode"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_compactMode" Color="Color.Primary">
                            @L["CompactMode"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_CompactMode"]
                        </MudText>
                    </MudStack>

                    <MudSelect @bind-Value="_accentColor" Label="@L["AccentColor"]" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("purple")">@L["Purple"]</MudSelectItem>
                        <MudSelectItem Value="@("blue")">@L["Blue"]</MudSelectItem>
                        <MudSelectItem Value="@("green")">@L["Green"]</MudSelectItem>
                        <MudSelectItem Value="@("red")">@L["Red"]</MudSelectItem>
                    </MudSelect>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveAppearanceSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveAppearanceSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Security" Class="mr-2" />
                    @L["PrivacySecurity"]
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_twoFactorAuth" Color="Color.Success">
                            @L["TwoFactorAuthentication"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_TwoFactorAuthentication"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_loginAlerts" Color="Color.Warning">
                            @L["LoginAlerts"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_LoginAlerts"]
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_profileVisibility" Color="Color.Info">
                            @L["PublicProfile"]
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            @L["Desc_PublicProfile"]
                        </MudText>
                    </MudStack>

                    <MudDivider Class="my-2" />

                    <MudButton Variant="Variant.Outlined" Color="Color.Warning" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.History" OnClick="ViewLoginHistory">
                        @L["ViewLoginHistory"]
                    </MudButton>

                    <MudButton Variant="Variant.Outlined" Color="Color.Error" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.ExitToApp" OnClick="LogoutAllDevices">
                        @L["LogoutAllDevices"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <MudItem xs="12">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Storage" Class="mr-2" />
                    @L["DataManagement"]
                </MudText>

                <MudGrid>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Info" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.Download" OnClick="ExportData">
                            @L["ExportMyData"]
                        </MudButton>
                    </MudItem>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Warning" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.CleaningServices" OnClick="ClearCache">
                            @L["ClearCache"]
                        </MudButton>
                    </MudItem>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Error" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.DeleteForever" OnClick="DeleteAccount">
                            @L["DeleteAccount"]
                        </MudButton>
                    </MudItem>
                </MudGrid>
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudStack>

@code {
    // General Settings
    private string _language = "en";
    private string _timezone = "UTC";
    private string _dateFormat = "MM/DD/YYYY";

    // Notification Settings
    private bool _emailNotifications = true;
    private bool _smsNotifications = false;
    private bool _pushNotifications = true;
    private bool _paymentNotifications = true;
    private bool _complaintNotifications = true;

    // Appearance Settings
    private bool _darkMode = true;
    private bool _compactMode = false;
    private string _accentColor = "purple";

    // Privacy & Security
    private bool _twoFactorAuth = false;
    private bool _loginAlerts = true;
    private bool _profileVisibility = false;

    private void SaveGeneralSettings()
    {
        Snackbar.Add(L["Snackbar_GeneralSettingsSaved"], Severity.Success);
    }

    private void SaveNotificationSettings()
    {
        Snackbar.Add(L["Snackbar_NotificationSettingsSaved"], Severity.Success);
    }

    private void SaveAppearanceSettings()
    {
        Snackbar.Add(L["Snackbar_AppearanceSettingsSaved"], Severity.Success);
    }

    private void ViewLoginHistory()
    {
        Snackbar.Add(L["Snackbar_LoginHistoryComingSoon"], Severity.Info);
    }

    private void LogoutAllDevices()
    {
        Snackbar.Add(L["Snackbar_LoggedOutAllDevices"], Severity.Success);
    }

    private void ExportData()
    {
        Snackbar.Add(L["Snackbar_DataExportStarted"], Severity.Info);
    }

    private void ClearCache()
    {
        Snackbar.Add(L["Snackbar_CacheCleared"], Severity.Success);
    }

    private void DeleteAccount()
    {
        Snackbar.Add(L["Snackbar_DeleteAccount_ContactSupport"], Severity.Warning);
    }
}
