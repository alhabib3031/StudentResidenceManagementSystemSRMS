@page "/settings"
@inject ISnackbar Snackbar
@inject Microsoft.Extensions.Localization.IStringLocalizer<SRMS.WebUI.Server.Resources.Resources> L
@attribute [Authorize]
@rendermode InteractiveServer

<PageTitle>@L["Settings"] - SRMS</PageTitle>

<MudStack Class="animate-fade-in w-full modern-card">
    <!-- Header -->
    <MudText Typo="Typo.h4" Class="text-gradient mb-4 font-bold">
        <MudIcon Icon="@Icons.Material.Filled.Settings" Class="mr-2" />
        Settings
    </MudText>

    <MudGrid>
        <!-- General Settings -->
        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Tune" Class="mr-2" />
                    General Settings
                </MudText>

                <MudStack Spacing="4">
                    <MudSelect @bind-Value="_language" Label="Language" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("en")">English</MudSelectItem>
                        <MudSelectItem Value="@("ar")">العربية</MudSelectItem>
                        <MudSelectItem Value="@("fr")">Français</MudSelectItem>
                    </MudSelect>

                    <MudSelect @bind-Value="_timezone" Label="Timezone" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("UTC")">UTC</MudSelectItem>
                        <MudSelectItem Value="@("EST")">Eastern Time</MudSelectItem>
                        <MudSelectItem Value="@("PST")">Pacific Time</MudSelectItem>
                        <MudSelectItem Value="@("GMT")">GMT</MudSelectItem>
                    </MudSelect>

                    <MudSelect @bind-Value="_dateFormat" Label="Date Format" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("MM/DD/YYYY")">MM/DD/YYYY</MudSelectItem>
                        <MudSelectItem Value="@("DD/MM/YYYY")">DD/MM/YYYY</MudSelectItem>
                        <MudSelectItem Value="@("YYYY-MM-DD")">YYYY-MM-DD</MudSelectItem>
                    </MudSelect>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveGeneralSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveGeneralSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <!-- Notification Settings -->
        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Notifications" Class="mr-2" />
                    Notification Settings
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_emailNotifications" Color="Color.Primary">
                            Email Notifications
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Receive notifications via email
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_smsNotifications" Color="Color.Primary">
                            SMS Notifications
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Receive notifications via SMS
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_pushNotifications" Color="Color.Primary">
                            Push Notifications
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Receive browser push notifications
                        </MudText>
                    </MudStack>

                    <MudDivider Class="my-2" />

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_paymentNotifications" Color="Color.Success">
                            Payment Notifications
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Get notified about payment updates
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_complaintNotifications" Color="Color.Warning">
                            Complaint Notifications
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Get notified about complaint updates
                        </MudText>
                    </MudStack>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveNotificationSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveNotificationSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <!-- Appearance Settings -->
        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Palette" Class="mr-2" />
                    Appearance
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_darkMode" Color="Color.Primary">
                            Dark Mode
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Use dark theme for better viewing
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_compactMode" Color="Color.Primary">
                            Compact Mode
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Reduce spacing for more content
                        </MudText>
                    </MudStack>

                    <MudSelect @bind-Value="_accentColor" Label="Accent Color" Variant="Variant.Outlined">
                        <MudSelectItem Value="@("purple")">Purple</MudSelectItem>
                        <MudSelectItem Value="@("blue")">Blue</MudSelectItem>
                        <MudSelectItem Value="@("green")">Green</MudSelectItem>
                        <MudSelectItem Value="@("red")">Red</MudSelectItem>
                    </MudSelect>

                    <MudButton Variant="Variant.Filled" Color="Color.Primary" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.Save" OnClick="SaveAppearanceSettings"
                        Class="btn-modern btn-primary">
                        @L["SaveAppearanceSettings"]
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <!-- Privacy & Security -->
        <MudItem xs="12" md="6">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Security" Class="mr-2" />
                    Privacy & Security
                </MudText>

                <MudStack Spacing="3">
                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_twoFactorAuth" Color="Color.Success">
                            Two-Factor Authentication
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Add an extra layer of security
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_loginAlerts" Color="Color.Warning">
                            Login Alerts
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Get notified of new login attempts
                        </MudText>
                    </MudStack>

                    <MudStack Spacing="0">
                        <MudSwitch T="bool" @bind-Checked="_profileVisibility" Color="Color.Info">
                            Public Profile
                        </MudSwitch>
                        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="ml-10">
                            Make your profile visible to others
                        </MudText>
                    </MudStack>

                    <MudDivider Class="my-2" />

                    <MudButton Variant="Variant.Outlined" Color="Color.Warning" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.History" OnClick="ViewLoginHistory">
                        View Login History
                    </MudButton>

                    <MudButton Variant="Variant.Outlined" Color="Color.Error" FullWidth="true"
                        StartIcon="@Icons.Material.Filled.ExitToApp" OnClick="LogoutAllDevices">
                        Logout All Devices
                    </MudButton>
                </MudStack>
            </MudPaper>
        </MudItem>

        <!-- Data Management -->
        <MudItem xs="12">
            <MudPaper Class="glass-card pa-6">
                <MudText Typo="Typo.h6" Class="mb-4">
                    <MudIcon Icon="@Icons.Material.Filled.Storage" Class="mr-2" />
                    Data Management
                </MudText>

                <MudGrid>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Info" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.Download" OnClick="ExportData">
                            @L["ExportMyData"]
                        </MudButton>
                    </MudItem>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Warning" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.CleaningServices" OnClick="ClearCache">
                            @L["ClearCache"]
                        </MudButton>
                    </MudItem>
                    <MudItem xs="12" md="4">
                        <MudButton Variant="Variant.Outlined" Color="Color.Error" FullWidth="true"
                            StartIcon="@Icons.Material.Filled.DeleteForever" OnClick="DeleteAccount">
                            @L["DeleteAccount"]
                        </MudButton>
                    </MudItem>
                </MudGrid>
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudStack>

@code {
    // General Settings
    private string _language = "en";
    private string _timezone = "UTC";
    private string _dateFormat = "MM/DD/YYYY";

    // Notification Settings
    private bool _emailNotifications = true;
    private bool _smsNotifications = false;
    private bool _pushNotifications = true;
    private bool _paymentNotifications = true;
    private bool _complaintNotifications = true;

    // Appearance Settings
    private bool _darkMode = true;
    private bool _compactMode = false;
    private string _accentColor = "purple";

    // Privacy & Security
    private bool _twoFactorAuth = false;
    private bool _loginAlerts = true;
    private bool _profileVisibility = false;

    private void SaveGeneralSettings()
    {
        Snackbar.Add("General settings saved successfully!", Severity.Success);
    }

    private void SaveNotificationSettings()
    {
        Snackbar.Add("Notification settings saved successfully!", Severity.Success);
    }

    private void SaveAppearanceSettings()
    {
        Snackbar.Add("Appearance settings saved successfully!", Severity.Success);
    }

    private void ViewLoginHistory()
    {
        Snackbar.Add("Login history feature coming soon!", Severity.Info);
    }

    private void LogoutAllDevices()
    {
        Snackbar.Add("Logged out from all devices!", Severity.Success);
    }

    private void ExportData()
    {
        Snackbar.Add("Data export started. You'll receive an email when ready.", Severity.Info);
    }

    private void ClearCache()
    {
        Snackbar.Add("Cache cleared successfully!", Severity.Success);
    }

    private void DeleteAccount()
    {
        Snackbar.Add("Please contact support to delete your account.", Severity.Warning);
    }
}
