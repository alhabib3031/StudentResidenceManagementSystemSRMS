@using SRMS.Domain.Rooms.Enums
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<Resource> L

<MudDialog>
    <TitleContent>
        <MudText Class="text-xl md:text-2xl font-bold flex items-center">
            <MudIcon Icon="@Icons.Material.Filled.Info" Class="mr-2" /> @L["RoomDetailsDialog_Title"]
        </MudText>
    </TitleContent>
    <DialogContent>
        @if (Room == null)
        {
            <MudText>@L["Common_Loading"]</MudText>
        }
        else
        {
            <MudGrid Spacing="2">
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_Residence"]:</MudText>
                    <MudText Class="text-sm">@Room.ResidenceName</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_RoomNumber"]:</MudText>
                    <MudText Class="text-sm">@Room.RoomNumber</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_Floor"]:</MudText>
                    <MudText Class="text-sm">@Room.Floor</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_RoomType"]:</MudText>
                    <MudText Class="text-sm">@L[Room.RoomType.ToString()]</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_TotalBeds"]:</MudText>
                    <MudText Class="text-sm">@Room.TotalBeds</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_OccupiedBeds"]:</MudText>
                    <MudText Class="text-sm">@Room.OccupiedBeds</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_MonthlyRent"]:</MudText>
                    <MudText Class="text-sm">@Room.MonthlyRentAmount @L["Room.MonthlyRentCurrency"]</MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudText Class="text-base font-semibold">@L["Room_Status"]:</MudText>
                    <MudChip T="string" Size="Size.Small" Color="@GetStatusColor(Room.Status)">@L[Room.Status.ToString()]
                    </MudChip>
                </MudItem>

                <MudItem xs="12">
                    <MudText Class="text-base font-semibold mt-4">@L["Room_Amenities"]</MudText>
                    <MudStack Row="true" Wrap="Wrap.Wrap">
                        <MudChip T="string"
                            Icon="@(Room.HasPrivateBathroom ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasPrivateBathroom ? Color.Success : Color.Error)">@L["Amenity_Bathroom"]
                        </MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasAirConditioning ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasAirConditioning ? Color.Success : Color.Error)">@L["Amenity_AC"]</MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasHeating ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasHeating ? Color.Success : Color.Error)">@L["Amenity_Heating"]</MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasWifi ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasWifi ? Color.Success : Color.Error)">@L["Amenity_WiFi"]</MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasDesk ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasDesk ? Color.Success : Color.Error)">@L["Amenity_Desk"]</MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasWardrobe ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasWardrobe ? Color.Success : Color.Error)">@L["Amenity_Wardrobe"]</MudChip>
                        <MudChip T="string"
                            Icon="@(Room.HasBalcony ? Icons.Material.Filled.Check : Icons.Material.Filled.Close)"
                            Color="@(Room.HasBalcony ? Color.Success : Color.Error)">@L["Amenity_Balcony"]</MudChip>
                    </MudStack>
                </MudItem>

                <MudItem xs="12">
                    <MudDivider Class="my-4" />
                    <MudText Typo="Typo.subtitle2">@L["Common_AuditInfo"]</MudText>
                    <MudText Typo="Typo.body2">@L["Common_Created"] @Room.CreatedAt.ToString("g") @L["Common_by"]
                        @Room.CreatedBy</MudText>
                    @if (Room.LastModifiedAt.HasValue)
                    {
                        <MudText Typo="Typo.body2">@L["Common_LastModified"] @Room.LastModifiedAt.Value.ToString("g")
                            @L["Common_by"] @Room.LastModifiedBy</MudText>
                    }
                </MudItem>
            </MudGrid>
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Cancel">@L["Common_Close"]</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; } = null!;
    [Parameter] public RoomDto Room { get; set; } = new();

    private void Cancel() => MudDialog.Cancel();

    private Color GetStatusColor(RoomStatus status)
    {
        return status switch
        {
            RoomStatus.Available => Color.Success,
            RoomStatus.Occupied => Color.Warning,
            RoomStatus.Maintenance => Color.Error,
            _ => Color.Default
        };
    }
}
